Log4j Vulnerability Scan, Mitigation, and Documentation using Nessus

Date: [25/09/2025]


1. Nessus Installation and Setup

### Step 1: Download Nessus
Visit https://www.tenable.com/downloads/nessus and download the appropriate `.deb` package.

Example:
wget https://downloads.nessus.org/nessus3dl.php?file=nessus-10.6.1-debian6_amd64.deb&licence_accept=yes

Step 2: Install Nessus
sudo dpkg -i nessus-10.6.1-debian6_amd64.deb

Step 3: Start Nessus Service
sudo systemctl start nessusd

Step 4: Access Web Interface
Open browser and go to: https://localhost:8834  
Create admin account → Choose Nessus Essentials → Enter activation code → Wait for plugin sync


2. Scan Configuration and Execution

### Scan Name: Localhost Full Scan  
Target: 127.0.0.1  
Policy: Log4j Vulnerability Scan  
Scan Duration: ~6 minutes  
Host Count: 1

### Vulnerabilities Detected:
- CVE-2021-44228 – Remote Code Execution (Log4Shell)
- CVE-2021-45046 – Bypass of initial fix
- CVE-2021-45105 – Denial of Service
- CVE-2021-44832 – Arbitrary Code Execution

Screenshot Reference: log4shell-list.png

3. Vulnerability Analysis

CVE-2021-44228
- Plugin ID: 155998
- Affected Component: log4j-core-2.14.1.jar
- Location: /usr/share/javasnoop/lib/
- Description: Allows remote attackers to execute arbitrary code via JNDI lookups.
- Fix: Replaced with log4j-core-2.17.1.jar
- Verification: Confirmed via manifest inspection and Nessus re-scan
- Screenshot: post-fix-verification.png

CVE-2021-45046
- Plugin ID: 156000
- Description: Incomplete fix for CVE-2021-44228; allows information leakage or RCE.
- Fix: Upgraded to log4j-core-2.17.1.jar
- Screenshot: log4shell-list.png

CVE-2021-45105
- Plugin ID: 156001
- Description: Uncontrolled recursion leading to DoS.
- Fix: Upgraded to log4j-core-2.17.1.jar
- Screenshot: log4shell-list.png


4. Post-Mitigation Verification

- Re-ran Nessus scan after replacing vulnerable JARs
- CVE-2021-44228 no longer detected
- Confirmed safe versions:
  - log4j-core-2.17.1.jar
  - log4j-api-2.24.3.jar (Maltego)
  - log4j-core-2.24.3.jar (ZAP)
- Screenshot: post-fix-verification.png


5. Directory Audit of Log4j JARs

Command used:
find / -name "log4j*.jar" 2>/dev/null

Verified presence of:
- Safe versions: 2.17.1, 2.24.3
- Removed: log4j-core-2.14.1.jar

Screenshot: log4j-jar-locations.png (optional)


6. Summary

- Nessus successfully identified multiple Log4j vulnerabilities
- All critical components were patched or replaced
- Post-fix scan confirmed remediation
- Screenshots and CVE-specific documentation included


End of File